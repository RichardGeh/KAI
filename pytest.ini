[pytest]
# Pytest Configuration for KAI Test Suite

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Markers for categorizing tests
markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests (may require external services)
    unit: marks tests as unit tests (fast, isolated)
    db: marks tests that require Neo4j database connection
    embedding: marks tests that use embedding service
    ui: marks tests that involve UI components

# Test output formatting
addopts =
    # Verbose output with test names
    -v
    # Show short summary for all test outcomes except passed
    -ra
    # Show local variables in tracebacks
    --showlocals
    # Strict marker checking (fail on unknown markers)
    --strict-markers
    # Disable output capturing (fixes conflict with kai_encoding_fix.py)
    -s

# Coverage options (use: pytest --cov)
# Note: Coverage is optional. To enable, run: pytest --cov=. --cov-report=html
# Exclude patterns: test_*.py,setup_initial_knowledge.py,*/site-packages/*

# Console output options
console_output_style = progress

# Timeout for slow tests (requires pytest-timeout if enabled)
# timeout = 300

# Log configuration
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Warnings
filterwarnings =
    # Allow typing module DeprecationWarnings (triggered by spaCy/pydantic in Python 3.13)
    ignore::DeprecationWarning:typing
    ignore::DeprecationWarning
    # Allow Neo4j driver warnings
    ignore::DeprecationWarning:neo4j.*
    # Allow spaCy warnings
    ignore::UserWarning:spacy.*
    ignore::DeprecationWarning:spacy.*
    # Allow pydantic v1 warnings in Python 3.13
    ignore::DeprecationWarning:pydantic.*

# Test execution order (requires pytest-randomly if enabled)
# randomly-seed = 42

# Minimum Python version
minversion = 3.13

# Custom test collection ignore patterns
norecursedirs = .git .tox dist build *.egg __pycache__ .pytest_cache

# Character encoding for output
# (helps with Windows console encoding issues)
# python_files uses UTF-8 by default
